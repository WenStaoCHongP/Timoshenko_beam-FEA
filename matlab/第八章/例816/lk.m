function [KE,Me] = lk
%------------------------------------------------------------------------
% ELEMENT STIFFNESS AND MASS MATRICES     
%-----------------------------------------------------------------------
E = 2.1e11; 
miu = 0.3;
a=0.1;
b=0.1;
t=0.01;
density=7800;
k1=21-6*miu+30*b^2/a^2+30*a^2/b^2;
k2=8*b^2-8*miu*b^2+40*a^2;
k3=8*a^2-8*miu*a^2+40*b^2;
k4=3*b+12*miu*b+30*a^2/b;
k5=3*a+12*miu*a+30*b^2/a;
k6=30*miu*a*b;
k7=-21+6*miu-30*b^2/a^2+15*a^2/b^2;
k8=-8*b^2+8*miu*b^2+20*a^2;
k9=-2*a^2+2*miu*a^2+20*b^2;
k10=-3*b-12*miu*b+15*a^2/b;
k11=3*a-3*miu*a+30*b^2/a;
k12=21-6*miu-15*b^2/a^2-15*a^2/b^2;
k13=2*b^2-2*miu*b^2+10*a^2;
k14=2*a^2-2*miu*a^2+10*b^2;
k15=-3*b+3*miu*b+15*a^2/b;
k16=-3*a+3*miu*a+15*b^2/a;
k17=-21+6*miu+15*b^2/a^2-30*a^2/b^2;
k18=-2*b^2+2*miu*b^2+20*a^2;
k19=-8*a^2+8*miu*a^2+20*b^2;
k20=3*b-3*miu*b+30*a^2/b;
k21=-3*a-12*miu*a+15*b^2/a;
KE = E*t^3/(360*(1-miu^2)*a*b)*...
   [k1  k4  -k5  k7  k10 -k11  k12  k15  -k16  k17   k20  -k21;
   k4   k2  -k6  k10 k8   0   -k15  k13   0    -k20  k18    0;
   -k5  -k6  k3  k11 0    k9   k16  0     k14  -k21   0    k19;
   k7   k10  k11 k1  k4   k5   k17  k20   k21  k12   k15   k16;
   k10  k8   0   k4  k2   k6   -k20 k18   0    -k15  k13   0;
   -k11  0   k9  k5  k6   k3   k21  0     k19   -k16  0    k14;
   k12 -k15  k16 k17 -k20 k21   k1  -k4   k5    k7    -k10 k11;
   k15  k13   0  k20 k18  0    -k4   k2   -k6   -k10  k8    0;
   -k16  0   k14 k21  0   k19   k5  -k6    k3    -k11  0   k9;
   k17 -k20 -k21 k12 -k15 -k16  k7  -k10  -k11   k1   -k4  -k5;
   k20  k18   0  k15  k13  0   -k10  k8     0   -k4   k2    k6;     
   -k21 0    k19 k16   0  k14   k11   0    k9   -k5   k6    k3];

Me=zeros(12);
mass=density*(2*a)*(2*b)*t/25200;
Me(1,1)=mass*3454;    Me(2,1)=mass*(922*b);  Me(3,1)=mass*(-922*a); Me(4,1)=mass*1226;     Me(5,1)=mass*(398*b);    Me(6,1)=mass*(548*a);
Me(7,1)=mass*394;      Me(8,1)=mass*(-232*b);  Me(9,1)=mass*(232*a);  Me(10,1)=mass*1226;    Me(11,1)=mass*(-548*b);  Me(12,1)=mass*(-398*a);
 
Me(2,2)=mass*(320*b^2);Me(3,2)=mass*(-252*a*b);Me(4,2)=mass*(398*b); Me(5,2)=mass*(160*b^2); Me(6,2)=mass*(168*a*b);
Me(7,2)=mass*(232*b);  Me(8,2)=mass*(-120*b^2);Me(9,2)=mass*(112*a*b);Me(10,2)=mass*(548*b); Me(11,2)=mass*(-240*b^2);Me(12,2)=mass*(-168*a*b);

Me(3,3)=mass*(320*a^2);Me(4,3)=-Me(6,1);        Me(5,3)=Me(12,2);       Me(6,3)=mass*(-240*a^2);Me(7,3)=-Me(9,1);        Me(8,3)=Me(9,2);
Me(9,3)=mass*(-120*a^2);Me(10,3)=Me(12,1);      Me(11,3)=Me(6,2);       Me(12,3)=Me(3,3)/2;

Me(4,4)=Me(1,1);       Me(5,4)=Me(2,1);        Me(6,4)=-Me(3,1);       Me(7,4)=mass*1226;         Me(8,4)=Me(11,1);        Me(9,4)=-Me(12,1);
Me(10,4)=Me(7,1);       Me(11,4)=Me(8,1);        Me(12,4)=-Me(9,1);

Me(5,5)=Me(2,2);        Me(6,5)=-Me(3,2);        Me(7,5)=-Me(11,1);      Me(8,5)=Me(11,2);        Me(9,5)=Me(6,2);
Me(10,5)=-Me(8,1);      Me(11,5)=Me(8,2);        Me(12,5)=-Me(9,2);

Me(6,6)=Me(3,3);        Me(7,6)=-Me(12,1);       Me(8,6)=-Me(6,2);        Me(9,6)=Me(12,3);        Me(10,6)=Me(9,1);
Me(11,6)=-Me(9,2);      Me(12,6)=Me(9,3);

Me(7,7)=Me(1,1);        Me(8,7)=-Me(2,1);       Me(9,7)=-Me(3,1);       Me(10,7)=Me(4,1);        Me(11,7)=-Me(5,1);       Me(12,7)=-Me(6,1);

Me(8,8)=Me(2,2);        Me(9,8)=Me(3,2);         Me(10,8)=-Me(4,2);      Me(11,8)=Me(5,2);        Me(12,8)=Me(6,2);

Me(9,9)=Me(3,3);        Me(10,9)=-Me(4,3);       Me(11,9)=Me(5,3);       Me(12,9)=Me(6,3);

Me(10,10)=Me(1,1);      Me(11,10)=-Me(2,1);      Me(12,10)=Me(3,1);

Me(11,11)=Me(2,2);      Me(12,11)=-Me(3,2);

Me(12,12)=Me(3,3);

for i=1:12
   for j=i:12
      Me(i,j)=Me(j,i);
   end
end
%-------------------------------------------------------------------------------------
